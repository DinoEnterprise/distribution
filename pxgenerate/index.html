<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Dynotic Text To Music</title>

<!-- PRELOAD LOGO -->
<link rel="preload" as="image" href="assets/logo_dynotic.png">

<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Outfit",sans-serif;}
body{background:#000;color:#fff;min-height:100vh;overflow-x:hidden;}

.nav{
    padding:18px 22px;
    border-bottom:1px solid rgba(255,255,255,0.1);
}
.logo{
    width:48px;
    border-radius:12px;
}

.hero{
    padding:60px 20px;
    text-align:center;
}
.hero h1{
    font-size:48px;
    font-weight:700;
    margin-bottom:10px;
}
.hero p{opacity:0.9;}

.form-box{
    width:90%;
    max-width:700px;
    margin:0 auto 60px;
    padding:24px;
    background:rgba(255,255,255,0.05);
    border-radius:16px;
    backdrop-filter:blur(10px);
}

/* FORM */
label{
    display:block;
    margin-bottom:6px;
    font-weight:600;
}
input, select, textarea{
    width:100%;
    padding:12px 14px;
    margin-bottom:18px;
    border-radius:10px;
    border:1px solid rgba(255,255,255,0.3);
    background:rgba(255,255,255,0.05);
    color:#fff;
}
textarea{min-height:120px;resize:vertical;}

button{
    width:100%;
    padding:14px;
    border-radius:16px;
    border:2px solid #fff;
    background:rgba(255,255,255,0.05);
    color:#fff;
    font-weight:600;
    cursor:pointer;
    transition:0.3s;
}
button:hover{background:rgba(255,255,255,0.1);}
button:disabled{
    opacity:0.4;
    cursor:not-allowed;
}

.limit-info{
    margin-top:12px;
    font-size:14px;
    opacity:0.8;
    text-align:center;
}

/* ANIMATION */
.fade-up{
    opacity:0;
    transform:translateY(30px);
    animation:fadeUp 0.9s ease forwards;
}
.delay-1{animation-delay:0.15s;}
.delay-2{animation-delay:0.3s;}

@keyframes fadeUp{
    to{opacity:1;transform:translateY(0);}
}
</style>
</head>

<body>

<!-- NAV -->
<div class="nav fade-up">
    <img 
        src="../assets/dynoticlogo.png"
        class="logo"
        loading="eager"
        decoding="async"
        alt="Dynotic Logo"
    >
</div>

<!-- HERO -->
<div class="hero fade-up delay-1">
    <h1>Text To Music</h1>
    <p>Generate music using text â€¢ 2x per day</p>
</div>

<!-- FORM -->
<div class="form-box fade-up delay-2">
<form id="musicForm">

    <label>Email</label>
    <input type="email" name="email" required>

    <label>Judul Lagu</label>
    <input type="text" name="title" required>

    <label>Style Music</label>
    <input type="text" name="style" placeholder="Lo-fi, chill, jazzy" required>

    <label>Vocal Gender</label>
    <select name="vocal_gender" required>
        <option value="">Select</option>
        <option value="Female">Perempuan</option>
        <option value="Male">Laki-laki</option>
        <option value="Auto">Auto</option>
    </select>

    <label>Lyrics</label>
    <textarea name="lyrics" required></textarea>

    <button type="submit" id="submitBtn">Generate</button>
    <div class="limit-info" id="limitInfo"></div>
</form>
</div>

<script>
/* USER ID */
if(!localStorage.getItem("dynotic_user_id")){
    localStorage.setItem(
        "dynotic_user_id",
        "user_" + Math.random().toString(36).slice(2)
    );
}

/* DAILY RESET */
const today = new Date().toISOString().slice(0,10);
if(localStorage.getItem("dynotic_date") !== today){
    localStorage.setItem("dynotic_date", today);
    localStorage.setItem("dynotic_generate_count", "0");
}

/* LIMIT */
const maxGenerate = 2;
let count = parseInt(localStorage.getItem("dynotic_generate_count")) || 0;

const btn = document.getElementById("submitBtn");
const info = document.getElementById("limitInfo");

function updateUI(){
    if(count >= maxGenerate){
        btn.disabled = true;
        btn.innerText = "Limit Reached";
        info.innerText = "Daily limit reached (2/2). Try again tomorrow.";
    }else{
        btn.disabled = false;
        btn.innerText = "Generate";
        info.innerText = `Remaining today: ${maxGenerate - count}`;
    }
}

/* REFRESH SAAT BACK */
window.addEventListener("pageshow", () => {
    count = parseInt(localStorage.getItem("dynotic_generate_count")) || 0;
    updateUI();
});

updateUI();

/* SUBMIT */
document.getElementById("musicForm").addEventListener("submit", function(e){
    e.preventDefault();
    if(count >= maxGenerate) return;

    count++;
    localStorage.setItem("dynotic_generate_count", count);

    btn.disabled = true;
    btn.innerText = "Generating...";

    fetch("https://formspree.io/f/xqarbjja", {
        method: "POST",
        body: new FormData(this),
        headers: { "Accept":"application/json" }
    })
    .then(() => window.location.href = "/success")
    .catch(() => {
        count--;
        localStorage.setItem("dynotic_generate_count", count);
        updateUI();
        alert("Error. Please try again.");
    });
});
</script>

</body>
</html>
