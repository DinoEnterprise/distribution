<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Profile | DynoPay</title>
<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:"Outfit",sans-serif;user-select:none;}
body{background:#f1f2f7;min-height:100vh;color:#111;animation:fadeIn .5s ease;-webkit-tap-highlight-color:transparent;}
@keyframes fadeIn{from{opacity:0;transform:translateY(15px);}to{opacity:1;transform:translateY(0);}}
@keyframes bounceIn{0%{transform:translateY(-20px);opacity:0;}50%{transform:translateY(10px);opacity:1;}70%{transform:translateY(-5px);}100%{transform:translateY(0);opacity:1;}}
@keyframes fadeSlideUp{from{opacity:0; transform:translateY(10px);}to{opacity:1; transform:translateY(0);}}

/* HEADER */
header{padding:12px 20px;display:flex;align-items:center;background:white;border-bottom:1px solid #eee;}
header img{height:50px;}

/* CARD */
.card{
  width:90%;
  margin:20px auto;
  background:#fff;
  border-radius:20px;
  padding:25px;
  border:1px solid #ececec;
  box-shadow:0 8px 18px rgba(0,0,0,.05);
  transition:.3s, transform 0.3s ease;
  animation:bounceIn 0.5s ease forwards;
}
.card:hover{transform:translateY(-2px); box-shadow:0 6px 16px rgba(0,0,0,.07);}

.card-title{font-size:14px;font-weight:600;margin-bottom:6px;}
.input-group{margin-bottom:15px;}
.input-group input{width:100%;padding:12px;border-radius:12px;border:1px solid #ddd;font-size:14px;outline:none;background:#f9f9f9;}
.input-group input:focus{border-color:#667eea;}

/* Buttons */
button{
  border:none;
  border-radius:14px;
  font-weight:600;
  cursor:pointer;
  transition:.15s ease;
}
button:hover{filter:brightness(90%);}
button:active{transform:scale(0.94); filter:brightness(70%);}

/* Buttons spesifik */
.logout-btn{
  width:100%;
  padding:14px;
  margin-top:10px;
  background:#111;
  color:#fff;
}
.change-pass-btn{
  padding:10px 14px;
  background:#111;
  color:#fff;
  font-size:14px;
}

/* Profile photo */
.profile-photo{width:120px;height:120px;border-radius:50%;object-fit:cover;border:2px solid #ddd;margin-bottom:12px;pointer-events:none;}

/* NAV */
.bottom-nav{
  background:#fff;
  border-top:1px solid #eee;
  padding:10px 0;
  display:flex;
  justify-content:space-around;
  align-items:center;
  position:fixed;
  bottom:0; left:0; width:100%;
}
.nav-item{
  text-align:center;
  font-size:13px;
  opacity:.75;
  cursor:pointer;
  padding:4px 14px;
  border-radius:12px;
  transition:.15s ease;
  user-select:none;
}
.nav-item img{width:28px;display:block;margin:auto;margin-bottom:4px;}
.nav-item.active{opacity:1;color:#667eea;}
.nav-item.active img{filter:brightness(1.2);}
.nav-item:hover{opacity:1;}
.nav-item:active{transform:scale(0.94);filter:brightness(85%);box-shadow: inset 0 2px 6px rgba(0,0,0,0.2);}

/* clickable */
.clickable{cursor:pointer; transition: transform 0.12s, filter 0.12s, box-shadow 0.12s;}
.clickable:active{transform:scale(0.94); filter:brightness(85%); box-shadow: inset 0 2px 6px rgba(0,0,0,0.2);}

/* Profile menu */
.profile-menu{
  position:fixed;
  bottom:60px;
  right:20px;
  width:180px;
  background:#fff;
  border-radius:12px;
  box-shadow:0 6px 18px rgba(0,0,0,.12);
  z-index:10;
  display:none;
  opacity:0;
  transform:translateY(20px);
  transition:opacity 0.25s ease, transform 0.25s ease;
}
.profile-menu.show{
  display:block;
  opacity:1;
  transform:translateY(0);
}
.profile-menu div{
  padding:12px 14px;
  border-bottom:1px solid #eee;
  font-size:14px;
  cursor:pointer;
}
.profile-menu div:last-child{border-bottom:none;}
.profile-menu div:hover{background:#f1f2f7;}
</style>
</head>
<body>

<header>
<img src="../assets/dynopay2.png" alt="DynoPay">
</header>

<!-- FOTO PROFIL -->
<div class="card" style="text-align:center;">
  <img id="profilePhoto" class="profile-photo" src="../assets/profile.png" alt="Profile Photo">
</div>

<!-- INFO ARTIS -->
<div class="card">
  <div class="card-title">Nama Artis</div>
  <div class="input-group">
    <input type="text" id="nama" readonly>
  </div>
  <div class="card-title">Email</div>
  <div class="input-group">
    <input type="text" id="email" readonly>
  </div>
  <div class="card-title">Label</div>
  <div class="input-group">
    <input type="text" id="label" readonly value="Dynotic">
  </div>

  <!-- PASSWORD INLINE -->
  <div class="card-title">Password</div>
  <div class="input-group" style="display:flex;align-items:center;gap:10px;">
    <input type="password" value="********" readonly style="flex:1;">
    <button class="change-pass-btn clickable" onclick="changePassword()">Ganti</button>
  </div>

  <!-- LOGOUT -->
  <button class="logout-btn clickable" onclick="logout()">Logout</button>
</div>

<div style="height:120px"></div>

<!-- Profile Menu -->
<div id="profileMenu" class="profile-menu clickable">
  <div onclick="goProfile()" class="clickable">Profile</div>
  <div onclick="logout()" class="clickable">Log Out</div>
</div>

<!-- Bottom nav -->
<div class="bottom-nav">
  <div class="nav-item clickable" onclick="dashboardClick()">
    <img src="../assets/dasboard.png" alt="Dashboard">Dashboard
  </div>
  <div class="nav-item clickable" onclick="withdrawClick()">
    <img src="../assets/withdraw.png" alt="Withdraw">Withdraw
  </div>
  <div class="nav-item clickable active">
    <img src="../assets/profile.png" alt="Profile">Profile
  </div>
</div>

<!-- FIREBASE -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
<script>
firebase.initializeApp({
  apiKey:"AIzaSyBRSkmZXbTPNupefSmjXvlKLDNsaeQ2zag",
  authDomain:"dynopay-2513c.firebaseapp.com",
  databaseURL:"https://dynopay-2513c-default-rtdb.asia-southeast1.firebasedatabase.app"
});

const auth = firebase.auth();
const db = firebase.database();

// Proteksi login
auth.onAuthStateChanged(user=>{
  if(!user) location.href="../login";
  else loadProfile(user.uid);
});

// Load profile
function loadProfile(uid){
  db.ref("users/"+uid).once("value").then(snap=>{
    if(snap.exists()){
      const data = snap.val();
      document.getElementById("nama").value = data.nama || "";
      document.getElementById("email").value = data.email || "";
      document.getElementById("profilePhoto").src = data.photoURL || "../assets/profile.png";
    }
  });
}

// Logout
function logout(){ auth.signOut().then(()=>console.log("Logged out — tidak reload")); }

// Nav clicks 
function goDashboard(){ window.location.href="../dasboard"; }
function goWithdraw(){ window.location.href="../withdraw"; }
// Change Password
function changePassword(){
  const newPass = prompt("Masukkan password baru:");
  if(!newPass) return;

  const user = firebase.auth().currentUser;
  if(user){
    user.updatePassword(newPass).then(()=>{
      alert("Password berhasil diubah!");
    }).catch(err=>{
      if(err.code === "auth/requires-recent-login"){
        alert("Silakan login ulang dulu untuk mengubah password.");
      } else {
        alert("Error: "+err.message);
      }
    });
  }
}

// Profile menu
function toggleProfileMenu(){
  const menu = document.getElementById("profileMenu");
  menu.classList.toggle("show");
}
function goProfile(){console.log("Profile click — tidak reload");}
</script>
</body>
</html>
